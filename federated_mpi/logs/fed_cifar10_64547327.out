    [Client 1] Initializing...
    [Client 3] Initializing...
    [Client 4] Initializing...
    [Client 2] Initializing...
=== Federated Server Started ===
Total processes: 5 (1 server + 4 clients)

Loading data from .npy files...
Training set: (50000, 32, 32, 3), Labels: (50000, 10)
Test set:     (10000, 32, 32, 3), Labels: (10000, 10)
    [Client 4] Round 1 - Waiting for global weights...
Loading data from .npy files...
Training set: (50000, 32, 32, 3), Labels: (50000, 10)
Test set:     (10000, 32, 32, 3), Labels: (10000, 10)
    [Client 1] Round 1 - Waiting for global weights...
Loading data from .npy files...
Training set: (50000, 32, 32, 3), Labels: (50000, 10)
Test set:     (10000, 32, 32, 3), Labels: (10000, 10)
    [Client 3] Round 1 - Waiting for global weights...
Loading data from .npy files...
Training set: (50000, 32, 32, 3), Labels: (50000, 10)
Test set:     (10000, 32, 32, 3), Labels: (10000, 10)
    [Client 2] Round 1 - Waiting for global weights...
Loading data from .npy files...
Training set: (50000, 32, 32, 3), Labels: (50000, 10)
Test set:     (10000, 32, 32, 3), Labels: (10000, 10)

===== Round 1 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 3] Round 1 - Training on local data...
    [Client 1] Round 1 - Training on local data...
    [Client 2] Round 1 - Training on local data...
    [Client 4] Round 1 - Training on local data...
    [Client 3] Round 1 - Sending updated weights to server...
    [Client 1] Round 1 - Sending updated weights to server...
    [Client 4] Round 1 - Sending updated weights to server...
    [Client 2] Round 1 - Sending updated weights to server...
    [Client 1] Round 2 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 2 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 2 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 2 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 1 Evaluation - Accuracy: 0.1675, Loss: 2.2182

===== Round 2 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 1] Round 2 - Training on local data...
    [Client 2] Round 2 - Training on local data...
    [Client 4] Round 2 - Training on local data...
    [Client 3] Round 2 - Training on local data...
    [Client 3] Round 2 - Sending updated weights to server...
    [Client 2] Round 2 - Sending updated weights to server...
    [Client 4] Round 2 - Sending updated weights to server...
    [Client 1] Round 2 - Sending updated weights to server...
    [Client 1] Round 3 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 3 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 3 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 3 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 2 Evaluation - Accuracy: 0.4862, Loss: 1.3972

===== Round 3 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 3] Round 3 - Training on local data...
    [Client 4] Round 3 - Training on local data...
    [Client 1] Round 3 - Training on local data...
    [Client 2] Round 3 - Training on local data...
    [Client 1] Round 3 - Sending updated weights to server...
    [Client 2] Round 3 - Sending updated weights to server...
    [Client 3] Round 3 - Sending updated weights to server...
    [Client 4] Round 3 - Sending updated weights to server...
    [Client 1] Round 4 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 4 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 4 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 4 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 3 Evaluation - Accuracy: 0.5900, Loss: 1.1544

===== Round 4 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 4] Round 4 - Training on local data...
    [Client 2] Round 4 - Training on local data...
    [Client 3] Round 4 - Training on local data...
    [Client 1] Round 4 - Training on local data...
    [Client 1] Round 4 - Sending updated weights to server...
    [Client 3] Round 4 - Sending updated weights to server...
    [Client 4] Round 4 - Sending updated weights to server...
    [Client 2] Round 4 - Sending updated weights to server...
    [Client 1] Round 5 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 5 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 5 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 5 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 4 Evaluation - Accuracy: 0.6426, Loss: 1.0039

===== Round 5 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 1] Round 5 - Training on local data...
    [Client 4] Round 5 - Training on local data...
    [Client 2] Round 5 - Training on local data...
    [Client 3] Round 5 - Training on local data...
    [Client 2] Round 5 - Sending updated weights to server...
    [Client 3] Round 5 - Sending updated weights to server...
    [Client 1] Round 5 - Sending updated weights to server...
    [Client 4] Round 5 - Sending updated weights to server...
    [Client 1] Round 6 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 6 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 6 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 6 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 5 Evaluation - Accuracy: 0.6633, Loss: 0.9366

===== Round 6 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 1] Round 6 - Training on local data...
    [Client 3] Round 6 - Training on local data...
    [Client 4] Round 6 - Training on local data...
    [Client 2] Round 6 - Training on local data...
    [Client 4] Round 6 - Sending updated weights to server...
    [Client 2] Round 6 - Sending updated weights to server...
    [Client 3] Round 6 - Sending updated weights to server...
    [Client 1] Round 6 - Sending updated weights to server...
    [Client 1] Round 7 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 7 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 7 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 7 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 6 Evaluation - Accuracy: 0.6959, Loss: 0.8536

===== Round 7 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 2] Round 7 - Training on local data...
    [Client 4] Round 7 - Training on local data...
    [Client 3] Round 7 - Training on local data...
    [Client 1] Round 7 - Training on local data...
    [Client 3] Round 7 - Sending updated weights to server...
    [Client 1] Round 7 - Sending updated weights to server...
    [Client 4] Round 7 - Sending updated weights to server...
    [Client 2] Round 7 - Sending updated weights to server...
    [Client 1] Round 8 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 8 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 8 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 8 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 7 Evaluation - Accuracy: 0.7294, Loss: 0.7787

===== Round 8 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 3] Round 8 - Training on local data...
    [Client 4] Round 8 - Training on local data...
    [Client 1] Round 8 - Training on local data...
    [Client 2] Round 8 - Training on local data...
    [Client 4] Round 8 - Sending updated weights to server...
    [Client 1] Round 8 - Sending updated weights to server...
    [Client 2] Round 8 - Sending updated weights to server...
    [Client 3] Round 8 - Sending updated weights to server...
    [Client 1] Round 9 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 9 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 9 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 9 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 8 Evaluation - Accuracy: 0.7268, Loss: 0.7755

===== Round 9 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 1] Round 9 - Training on local data...
    [Client 4] Round 9 - Training on local data...
    [Client 2] Round 9 - Training on local data...
    [Client 3] Round 9 - Training on local data...
    [Client 3] Round 9 - Sending updated weights to server...
    [Client 1] Round 9 - Sending updated weights to server...
    [Client 2] Round 9 - Sending updated weights to server...
    [Client 4] Round 9 - Sending updated weights to server...
    [Client 1] Round 10 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 10 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 10 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 10 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 9 Evaluation - Accuracy: 0.7544, Loss: 0.7016

===== Round 10 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 1] Round 10 - Training on local data...
    [Client 3] Round 10 - Training on local data...
    [Client 2] Round 10 - Training on local data...
    [Client 4] Round 10 - Training on local data...
    [Client 4] Round 10 - Sending updated weights to server...
    [Client 2] Round 10 - Sending updated weights to server...
    [Client 1] Round 10 - Sending updated weights to server...
    [Client 3] Round 10 - Sending updated weights to server...
    [Client 1] Round 11 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 11 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 11 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 11 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 10 Evaluation - Accuracy: 0.7532, Loss: 0.7020

===== Round 11 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 1] Round 11 - Training on local data...
    [Client 2] Round 11 - Training on local data...
    [Client 4] Round 11 - Training on local data...
    [Client 3] Round 11 - Training on local data...
    [Client 3] Round 11 - Sending updated weights to server...
    [Client 1] Round 11 - Sending updated weights to server...
    [Client 4] Round 11 - Sending updated weights to server...
    [Client 2] Round 11 - Sending updated weights to server...
    [Client 1] Round 12 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 12 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 12 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 12 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 11 Evaluation - Accuracy: 0.7666, Loss: 0.6699

===== Round 12 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 1] Round 12 - Training on local data...
    [Client 3] Round 12 - Training on local data...
    [Client 2] Round 12 - Training on local data...
    [Client 4] Round 12 - Training on local data...
    [Client 4] Round 12 - Sending updated weights to server...
    [Client 3] Round 12 - Sending updated weights to server...
    [Client 1] Round 12 - Sending updated weights to server...
    [Client 2] Round 12 - Sending updated weights to server...
    [Client 1] Round 13 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 13 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 13 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 13 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 12 Evaluation - Accuracy: 0.7725, Loss: 0.6505

===== Round 13 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 4] Round 13 - Training on local data...
    [Client 1] Round 13 - Training on local data...
    [Client 3] Round 13 - Training on local data...
    [Client 2] Round 13 - Training on local data...
    [Client 1] Round 13 - Sending updated weights to server...
    [Client 2] Round 13 - Sending updated weights to server...
    [Client 3] Round 13 - Sending updated weights to server...
    [Client 4] Round 13 - Sending updated weights to server...
    [Client 1] Round 14 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 14 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 14 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 14 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 13 Evaluation - Accuracy: 0.7796, Loss: 0.6301

===== Round 14 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 1] Round 14 - Training on local data...
    [Client 2] Round 14 - Training on local data...
    [Client 3] Round 14 - Training on local data...
    [Client 4] Round 14 - Training on local data...
    [Client 4] Round 14 - Sending updated weights to server...
    [Client 3] Round 14 - Sending updated weights to server...
    [Client 2] Round 14 - Sending updated weights to server...
    [Client 1] Round 14 - Sending updated weights to server...
    [Client 1] Round 15 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 15 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 15 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 15 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 14 Evaluation - Accuracy: 0.7937, Loss: 0.5941

===== Round 15 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 3] Round 15 - Training on local data...
    [Client 1] Round 15 - Training on local data...
    [Client 2] Round 15 - Training on local data...
    [Client 4] Round 15 - Training on local data...
    [Client 2] Round 15 - Sending updated weights to server...
    [Client 3] Round 15 - Sending updated weights to server...
    [Client 4] Round 15 - Sending updated weights to server...
    [Client 1] Round 15 - Sending updated weights to server...
    [Client 1] Round 16 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 16 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 16 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 16 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 15 Evaluation - Accuracy: 0.8013, Loss: 0.5789

===== Round 16 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 4] Round 16 - Training on local data...
    [Client 1] Round 16 - Training on local data...
    [Client 2] Round 16 - Training on local data...
    [Client 3] Round 16 - Training on local data...
    [Client 3] Round 16 - Sending updated weights to server...
    [Client 2] Round 16 - Sending updated weights to server...
    [Client 4] Round 16 - Sending updated weights to server...
    [Client 1] Round 16 - Sending updated weights to server...
    [Client 1] Round 17 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 17 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 17 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 17 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 16 Evaluation - Accuracy: 0.8062, Loss: 0.5691

===== Round 17 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 2] Round 17 - Training on local data...
    [Client 1] Round 17 - Training on local data...
    [Client 4] Round 17 - Training on local data...
    [Client 3] Round 17 - Training on local data...
    [Client 2] Round 17 - Sending updated weights to server...
    [Client 3] Round 17 - Sending updated weights to server...
    [Client 1] Round 17 - Sending updated weights to server...
    [Client 1] Round 18 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 18 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 18 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 17 - Sending updated weights to server...
    [Client 4] Round 18 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 17 Evaluation - Accuracy: 0.8093, Loss: 0.5585

===== Round 18 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 3] Round 18 - Training on local data...
    [Client 2] Round 18 - Training on local data...
    [Client 1] Round 18 - Training on local data...
    [Client 4] Round 18 - Training on local data...
    [Client 3] Round 18 - Sending updated weights to server...
    [Client 1] Round 18 - Sending updated weights to server...
    [Client 1] Round 19 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 4] Round 18 - Sending updated weights to server...
    [Client 2] Round 18 - Sending updated weights to server...
    [Client 2] Round 19 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 19 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 19 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 18 Evaluation - Accuracy: 0.8218, Loss: 0.5287

===== Round 19 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 1] Round 19 - Training on local data...
    [Client 2] Round 19 - Training on local data...
    [Client 4] Round 19 - Training on local data...
    [Client 3] Round 19 - Training on local data...
    [Client 3] Round 19 - Sending updated weights to server...
    [Client 2] Round 19 - Sending updated weights to server...
    [Client 4] Round 19 - Sending updated weights to server...
    [Client 1] Round 19 - Sending updated weights to server...
    [Client 1] Round 20 - Waiting for global weights...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Round 20 - Waiting for global weights...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Round 20 - Waiting for global weights...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Round 20 - Waiting for global weights...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 19 Evaluation - Accuracy: 0.8216, Loss: 0.5288

===== Round 20 =====
Broadcasting global model to all clients...
Waiting for model weights from client 1...
    [Client 2] Round 20 - Training on local data...
    [Client 3] Round 20 - Training on local data...
    [Client 4] Round 20 - Training on local data...
    [Client 1] Round 20 - Training on local data...
    [Client 4] Round 20 - Sending updated weights to server...
    [Client 3] Round 20 - Sending updated weights to server...
    [Client 1] Round 20 - Sending updated weights to server...
    [Client 2] Round 20 - Sending updated weights to server...
    [Client 1] Training complete. Waiting for others...
Received weights from client 1
Waiting for model weights from client 2...
    [Client 2] Training complete. Waiting for others...
Received weights from client 2
Waiting for model weights from client 3...
    [Client 3] Training complete. Waiting for others...
Received weights from client 3
Waiting for model weights from client 4...
    [Client 4] Training complete. Waiting for others...
Received weights from client 4
Averaging model weights...
Evaluating updated global model on test set...
Round 20 Evaluation - Accuracy: 0.8291, Loss: 0.5031

=== Federated Training Complete ===
Generating training metrics plot...
